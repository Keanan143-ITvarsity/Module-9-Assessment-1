<!DOCTYPE html>
<html>
    <head>
        <title>Countdown Timer</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=width-device, initial-scale=1.0">
        <link rel="stylesheet" href="css/style.css">

    </head>
    <body>
        <div class="Container">
            <svg id="progressBarContainer" width="144" height="300">
                <defs>
                    <pattern id="pattern1" x="0" y="0" width="12" height="12" patternUnits="userSpaceOnUse">
                        <circle cx="5" cy="5" r="3" stroke="0" fill="#FE9522" />
                    </pattern>
                </defs>
                <rect id="progressBar" x="0" y="0" width="144" height="300" style="fill: url(#pattern1);" />
            </svg>

            <div id="clock">
                <p>Ready</p>
            </div>

            <div id="content">
                <select class="selector" id="hours">
                    <option value="0">0 hours</option>
                    <option value="1">1 hour</option>
                    <option value="2">2 hours</option>
                    <option value="3">3 hours</option>
                    <option value="4">4 hours</option>
                    <option value="5">5 hours</option>
                    <option value="6">6 hours</option>
                    <option value="7">7 hours</option>
                    <option value="8">8 hours</option>
                    <option value="9">9 hours</option>
                    <option value="10">10 hours</option>
                    <option value="11">11 hours</option>
                    <option value="12">12 hours</option>
                    <option value="13">13 hours</option>
                    <option value="14">14 hours</option>
                    <option value="15">15 hours</option>
                    <option value="16">16 hours</option>
                    <option value="17">17 hours</option>
                    <option value="18">18 hours</option>
                    <option value="19">19 hours</option>
                    <option value="20">20 hours</option>
                    <option value="21">21 hours</option>
                    <option value="22">22 hours</option>
                    <option value="23">23 hours</option>
                    <option value="24">24 hours</option>
                </select>

                <select class="selector" id="minutes">
                    <option value="0">0 mins</option>
                    <option value="1">1 min</option>
                    <option value="2">2 mins</option>
                    <option value="3">3 mins</option>
                    <option value="4">4 mins</option>
                    <option value="5">5 mins</option>
                    <option value="6">6 mins</option>
                    <option value="7">7 mins</option>
                    <option value="8">8 mins</option>
                    <option value="9">9 mins</option>
                    <option value="10">10 mins</option>
                    <option value="11">11 mins</option>
                    <option value="12">12 mins</option>
                    <option value="13">13 mins</option>
                    <option value="14">14 mins</option>
                    <option value="15">15 mins</option>
                    <option value="16">16 mins</option>
                    <option value="17">17 mins</option>
                    <option value="18">18 mins</option>
                    <option value="19">19 mins</option>
                    <option value="20">20 mins</option>
                    <option value="21">21 mins</option>
                    <option value="22">22 mins</option>
                    <option value="23">23 mins</option>
                    <option value="24">24 mins</option>
                    <option value="25">25 mins</option>
                    <option value="26">26 mins</option>
                    <option value="27">27 mins</option>
                    <option value="28">28 mins</option>
                    <option value="29">29 mins</option>
                    <option value="30">30 mins</option>
                    <option value="31">31 mins</option>
                    <option value="32">32 mins</option>
                    <option value="33">33 mins</option>
                    <option value="34">34 mins</option>
                    <option value="35">35 mins</option>
                    <option value="36">36 mins</option>
                    <option value="37">37 mins</option>
                    <option value="38">38 mins</option>
                    <option value="39">39 mins</option>
                    <option value="40">40 mins</option>
                    <option value="41">41 min</option>
                    <option value="42">42 mins</option>
                    <option value="43">43 mins</option>
                    <option value="44">44 mins</option>
                    <option value="45">45 mins</option>
                    <option value="46">46 mins</option>
                    <option value="47">47 mins</option>
                    <option value="48">48 mins</option>
                    <option value="49">49 mins</option>
                    <option value="50">50 mins</option>
                    <option value="51">51 mins</option>
                    <option value="52">52 mins</option>
                    <option value="53">53 mins</option>
                    <option value="54">54 mins</option>
                    <option value="55">55 mins</option>
                    <option value="56">56 mins</option>
                    <option value="57">57 mins</option>
                    <option value="58">58 mins</option>
                    <option value="59">59 mins</option>
                    <option value="60">60 mins</option>
                </select>

                <select class="selector" id="seconds">
                    <option value="0">0 seconds</option>
                    <option value="1">1 second</option>
                    <option value="2">2 seconds</option>
                    <option value="3">3 seconds</option>
                    <option value="4">4 seconds</option>
                    <option value="5">5 seconds</option>
                    <option value="6">6 seconds</option>
                    <option value="7">7 seconds</option>
                    <option value="8">8 seconds</option>
                    <option value="9">9 seconds</option>
                    <option value="10">10 seconds</option>
                    <option value="11">11 seconds</option>
                    <option value="12">12 seconds</option>
                    <option value="13">13 seconds</option>
                    <option value="14">14 seconds</option>
                    <option value="15">15 seconds</option>
                    <option value="16">16 seconds</option>
                    <option value="17">17 seconds</option>
                    <option value="18">18 seconds</option>
                    <option value="19">19 seconds</option>
                    <option value="20">20 seconds</option>
                    <option value="21">21 seconds</option>
                    <option value="22">22 seconds</option>
                    <option value="23">23 seconds</option>
                    <option value="24">24 seconds</option>
                    <option value="25">25 seconds</option>
                    <option value="26">26 seconds</option>
                    <option value="27">27 seconds</option>
                    <option value="28">28 seconds</option>
                    <option value="29">29 seconds</option>
                    <option value="30">30 seconds</option>
                    <option value="31">31 seconds</option>
                    <option value="32">32 seconds</option>
                    <option value="33">33 seconds</option>
                    <option value="34">34 seconds</option>
                    <option value="35">35 seconds</option>
                    <option value="36">36 seconds</option>
                    <option value="37">37 seconds</option>
                    <option value="38">38 seconds</option>
                    <option value="39">39 seconds</option>
                    <option value="40">40 seconds</option>
                    <option value="41">41 seconds</option>
                    <option value="42">42 seconds</option>
                    <option value="43">43 seconds</option>
                    <option value="44">44 seconds</option>
                    <option value="45">45 seconds</option>
                    <option value="46">46 seconds</option>
                    <option value="47">47 seconds</option>
                    <option value="48">48 seconds</option>
                    <option value="49">49 seconds</option>
                    <option value="50">50 seconds</option>
                    <option value="51">51 seconds</option>
                    <option value="52">52 seconds</option>
                    <option value="53">53 seconds</option>
                    <option value="54">54 seconds</option>
                    <option value="55">55 seconds</option>
                    <option value="56">56 seconds</option>
                    <option value="57">57 seconds</option>
                    <option value="58">58 seconds</option>
                    <option value="59">59 seconds</option>
                    <option value="60">60 seconds</option>
                </select>

            </div>
            <div class="buttonSection">
                <div class="button1">
                    <button class="roundButton" id="start">Start</button>
                </div>
                <div class="button2">
                    <button class="roundButton" id="cancel">Stop</button>
                </div>
            </div>
        </div>

        <script>
            document.getElementById("start").addEventListener('click', startTimer);
            document.getElementById("cancel").addEventListener('click', cancelledButtonPressed);

            var startTime;
            var endTime;
            var origTirmePeriod;
            var newTimePeriod;
            var timer;
            var cancelled = false;

            function startTimer(){
                cancelled = false;

                startTime = new Date();
                endTime = getEndTime();

                origTirmePeriod = endTime.getTime() - startTime.getTime();
                newTimePeriod = origTirmePeriod;

                timer = setInterval(displayCountdown, 1000);
            }

            function displayCountdown(){
                var timeLeft = msToTime(newTimePeriod);

                document.getElementById("clock").innerHTML= `<p>${timeLeft["hours"]}h ${timeLeft["minutes"]}m ${timeLeft["seconds"]}s </p>`;

                var newHeight = Math.floor(newTimePeriod / origTirmePeriod * 100) * 3;
                document.getElementById("progressBar").setAttribute("height", newHeight);

                newTimePeriod -= 1000;

                if(newTimePeriod <0 || cancelled){
                    clearInterval(timer);
                    document.getElementById("clock").innerHTML = "<p>Done!</p>";
                }

            }

            function cancelledButtonPressed(){
                cancelled = true;
            }

            function msToTime(milliseconds){
                var mHour = 1000 * 60 * 60;
                var mMinute = 1000 * 60;
                var mSecond = 1000;

                var hours = Math.floor(milliseconds / mHour);
                var minutes = Math.floor((milliseconds % mHour)/ mMinute);
                var seconds = Math.floor((milliseconds % mMinute) / mSecond);

                var time = [];
                time["hours"] = hours;
                time["minutes"] = minutes;
                time["seconds"] = seconds;

                return time;

            }

            function getEndTime(){
                var dt = new Date();

                var hours = parseInt(document.getElementById("hours").value);
                var minutes = parseInt(document.getElementById("minutes").value);
                var seconds = parseInt(document.getElementById("seconds").value);

                dt.setHours(dt.getHours() +  hours);
                dt.setMinutes(dt.getMinutes() +  minutes);
                dt.setSeconds(dt.getSeconds() +  seconds);

                return dt;

            }

        </script>
    </body>
</html>